<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokemon Battle Predictor</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #e3350d;
            --secondary-color: #3b5ba7;
            --light-gray: #f5f5f5;
            --dark-gray: #333;
            --border-radius: 8px;
            --box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            max-width: 100%;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--light-gray);
            line-height: 1.6;
            color: var(--dark-gray);
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
        }
        
        h1 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 20px;
            font-size: 2.2rem;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
            }
        }
        
        .battle-form {
            background-color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-gray);
        }
        
        select, input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
            transition: var(--transition);
            font-family: 'Poppins', sans-serif;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(59, 91, 167, 0.2);
        }
        
        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 16px;
            display: block;
            margin: 20px auto 0;
            transition: var(--transition);
            font-weight: 600;
            width: 100%;
            max-width: 300px;
            font-family: 'Poppins', sans-serif;
        }
        
        button:hover {
            background-color: #2a4078;
            transform: translateY(-2px);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        button:disabled {
            background-color: #a0a0a0;
            cursor: not-allowed;
            transform: none;
        }
        
        .pokemon-container {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            margin-top: 20px;
            gap: 20px;
        }
        
        @media (max-width: 768px) {
            .pokemon-container {
                flex-direction: column;
                gap: 30px;
            }
        }
        
        .pokemon-select {
            width: 100%;
        }
        
        .search-box {
            margin-bottom: 15px;
        }
        
        .filter-options {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .filter-options select {
            width: 100%;
            margin-bottom: 8px;
        }
        
        .filter-group {
            width: 48%;
        }
        
        @media (max-width: 500px) {
            .filter-group {
                width: 100%;
            }
        }
        
        .filter-label {
            display: block;
            font-size: 14px;
            margin-bottom: 4px;
            color: #666;
            font-weight: 500;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
            font-style: italic;
            color: #666;
            padding: 10px;
        }
        
        .loading-icon {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(59, 91, 167, 0.3);
            border-radius: 50%;
            border-top-color: var(--secondary-color);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
            vertical-align: middle;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .note {
            margin-top: 30px;
            padding: 18px;
            background-color: #f8f8f8;
            border-left: 4px solid var(--secondary-color);
            font-size: 15px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        .pokemon-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            margin-top: 10px;
            display: none;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS devices */
        }
        
        .pokemon-item {
            padding: 12px 15px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            transition: var(--transition);
        }
        
        .pokemon-item:hover, .pokemon-item:active {
            background-color: #f0f4f9;
        }
        
        .pokemon-item:last-child {
            border-bottom: none;
        }
        
        .no-results {
            padding: 15px;
            font-style: italic;
            color: #999;
            text-align: center;
        }
        
        .selection-display {
            margin-top: 12px;
            padding: 12px;
            background-color: #f0f4f9;
            border-radius: var(--border-radius);
            display: none;
        }
        
        .selection-display.active {
            display: block;
            border-left: 3px solid var(--secondary-color);
        }
        
        .pokemon-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .pokemon-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--secondary-color);
        }
        
        .remove-selection {
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            margin: 0;
            padding: 5px;
            width: auto;
            font-size: 14px;
        }
        
        .remove-selection:hover {
            color: var(--primary-color);
            background: none;
            transform: none;
        }
        
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pokemon Battle Predictor</h1>
        <div class="battle-form">
            <form action="/predict" method="post" id="battle-form">
                <div class="pokemon-container">
                    <div class="pokemon-select">
                        <div class="form-group">
                            <label for="pokemon1">First Pokemon:</label>
                            <input type="text" id="pokemon1-search" placeholder="Search by ID, name, type or generation..." autocomplete="off">
                            <div class="filter-options">
                                <div class="filter-group">
                                    <span class="filter-label">Type 1:</span>
                                    <select id="pokemon1-type1">
                                        <option value="">Any Type 1</option>
                                        <option value="Normal">Normal</option>
                                        <option value="Fire">Fire</option>
                                        <option value="Water">Water</option>
                                        <option value="Grass">Grass</option>
                                        <option value="Flying">Flying</option>
                                        <option value="Fighting">Fighting</option>
                                        <option value="Poison">Poison</option>
                                        <option value="Electric">Electric</option>
                                        <option value="Ground">Ground</option>
                                        <option value="Rock">Rock</option>
                                        <option value="Psychic">Psychic</option>
                                        <option value="Ice">Ice</option>
                                        <option value="Bug">Bug</option>
                                        <option value="Ghost">Ghost</option>
                                        <option value="Steel">Steel</option>
                                        <option value="Dragon">Dragon</option>
                                        <option value="Dark">Dark</option>
                                        <option value="Fairy">Fairy</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <span class="filter-label">Type 2:</span>
                                    <select id="pokemon1-type2">
                                        <option value="">Any Type 2</option>
                                        <option value="Normal">Normal</option>
                                        <option value="Fire">Fire</option>
                                        <option value="Water">Water</option>
                                        <option value="Grass">Grass</option>
                                        <option value="Flying">Flying</option>
                                        <option value="Fighting">Fighting</option>
                                        <option value="Poison">Poison</option>
                                        <option value="Electric">Electric</option>
                                        <option value="Ground">Ground</option>
                                        <option value="Rock">Rock</option>
                                        <option value="Psychic">Psychic</option>
                                        <option value="Ice">Ice</option>
                                        <option value="Bug">Bug</option>
                                        <option value="Ghost">Ghost</option>
                                        <option value="Steel">Steel</option>
                                        <option value="Dragon">Dragon</option>
                                        <option value="Dark">Dark</option>
                                        <option value="Fairy">Fairy</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="width: 100%;">
                                    <span class="filter-label">Generation:</span>
                                    <select id="pokemon1-generation">
                                        <option value="">Any Generation</option>
                                        <option value="1">Gen 1</option>
                                        <option value="2">Gen 2</option>
                                        <option value="3">Gen 3</option>
                                        <option value="4">Gen 4</option>
                                        <option value="5">Gen 5</option>
                                        <option value="6">Gen 6</option>
                                        <option value="7">Gen 7</option>
                                    </select>
                                </div>
                            </div>
                            <div id="pokemon1-list" class="pokemon-list"></div>
                            <input type="hidden" name="pokemon1" id="pokemon1" required>
                            <div id="pokemon1-selection" class="selection-display">
                                <div class="pokemon-header">
                                    <div class="pokemon-title">Selected Pokemon</div>
                                    <button type="button" class="remove-selection" id="remove-pokemon1">Clear</button>
                                </div>
                                <div id="pokemon1-details"></div>
                            </div>
                        </div>
                    </div>
                    <div class="pokemon-select">
                        <div class="form-group">
                            <label for="pokemon2">Second Pokemon:</label>
                            <input type="text" id="pokemon2-search" placeholder="Search by ID, name, type or generation..." autocomplete="off">
                            <div class="filter-options">
                                <div class="filter-group">
                                    <span class="filter-label">Type 1:</span>
                                    <select id="pokemon2-type1">
                                        <option value="">Any Type 1</option>
                                        <option value="Normal">Normal</option>
                                        <option value="Fire">Fire</option>
                                        <option value="Water">Water</option>
                                        <option value="Grass">Grass</option>
                                        <option value="Flying">Flying</option>
                                        <option value="Fighting">Fighting</option>
                                        <option value="Poison">Poison</option>
                                        <option value="Electric">Electric</option>
                                        <option value="Ground">Ground</option>
                                        <option value="Rock">Rock</option>
                                        <option value="Psychic">Psychic</option>
                                        <option value="Ice">Ice</option>
                                        <option value="Bug">Bug</option>
                                        <option value="Ghost">Ghost</option>
                                        <option value="Steel">Steel</option>
                                        <option value="Dragon">Dragon</option>
                                        <option value="Dark">Dark</option>
                                        <option value="Fairy">Fairy</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <span class="filter-label">Type 2:</span>
                                    <select id="pokemon2-type2">
                                        <option value="">Any Type 2</option>
                                        <option value="Normal">Normal</option>
                                        <option value="Fire">Fire</option>
                                        <option value="Water">Water</option>
                                        <option value="Grass">Grass</option>
                                        <option value="Flying">Flying</option>
                                        <option value="Fighting">Fighting</option>
                                        <option value="Poison">Poison</option>
                                        <option value="Electric">Electric</option>
                                        <option value="Ground">Ground</option>
                                        <option value="Rock">Rock</option>
                                        <option value="Psychic">Psychic</option>
                                        <option value="Ice">Ice</option>
                                        <option value="Bug">Bug</option>
                                        <option value="Ghost">Ghost</option>
                                        <option value="Steel">Steel</option>
                                        <option value="Dragon">Dragon</option>
                                        <option value="Dark">Dark</option>
                                        <option value="Fairy">Fairy</option>
                                    </select>
                                </div>
                                <div class="filter-group" style="width: 100%;">
                                    <span class="filter-label">Generation:</span>
                                    <select id="pokemon2-generation">
                                        <option value="">Any Generation</option>
                                        <option value="1">Gen 1</option>
                                        <option value="2">Gen 2</option>
                                        <option value="3">Gen 3</option>
                                        <option value="4">Gen 4</option>
                                        <option value="5">Gen 5</option>
                                        <option value="6">Gen 6</option>
                                        <option value="7">Gen 7</option>
                                    </select>
                                </div>
                            </div>
                            <div id="pokemon2-list" class="pokemon-list"></div>
                            <input type="hidden" name="pokemon2" id="pokemon2" required>
                            <div id="pokemon2-selection" class="selection-display">
                                <div class="pokemon-header">
                                    <div class="pokemon-title">Selected Pokemon</div>
                                    <button type="button" class="remove-selection" id="remove-pokemon2">Clear</button>
                                </div>
                                <div id="pokemon2-details"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="submit" id="predict-btn">Predict Battle Winner</button>
                <div class="loading" id="loading-message">
                    <div class="loading-icon"></div>
                    Predicting battle outcome... Please wait.
                </div>
            </form>
        </div>
        <div class="note">
            <p>This application uses a machine learning model to predict Pokemon battle outcomes. Search for Pokemon by their ID number, name, type, or generation, then select two Pokemon and click "Predict Battle Winner" to see which one would win in a battle.</p>
        </div>
    </div>

    <script>
        // Pokemon data will be loaded from the server
        let pokemonData = {{ pokemon_data|safe }};

        // Function to filter and display Pokemon in the list
        function filterPokemon(searchText, type1Filter, type2Filter, genFilter, listElement, inputElement, selectionElement, detailsElement) {
            let results = [];
            searchText = searchText.toLowerCase();
            
            for (let pokemon of pokemonData) {
                // Check if Pokemon matches the search criteria
                let matchesSearch = false;
                if (searchText === '') {
                    matchesSearch = true;
                } else if (pokemon.id.toString() === searchText) {
                    matchesSearch = true;
                } else if (pokemon.name.toLowerCase().includes(searchText)) {
                    matchesSearch = true;
                } else if (pokemon.type1.toLowerCase().includes(searchText) || 
                          (pokemon.type2 && pokemon.type2.toLowerCase().includes(searchText))) {
                    matchesSearch = true;
                } else if (pokemon.generation.toString() === searchText) {
                    matchesSearch = true;
                }
                
                // Check if Pokemon matches the type1 filter
                let matchesType1 = true;
                if (type1Filter !== '') {
                    matchesType1 = pokemon.type1 === type1Filter;
                }
                
                // Check if Pokemon matches the type2 filter
                let matchesType2 = true;
                if (type2Filter !== '') {
                    matchesType2 = pokemon.type2 === type2Filter;
                }
                
                // Check if Pokemon matches the generation filter
                let matchesGen = true;
                if (genFilter !== '') {
                    matchesGen = pokemon.generation.toString() === genFilter;
                }
                
                // If Pokemon matches all criteria, add to results
                if (matchesSearch && matchesType1 && matchesType2 && matchesGen) {
                    results.push(pokemon);
                }
            }
            
            // Display results
            listElement.innerHTML = '';
            listElement.style.display = 'block';
            
            if (results.length === 0) {
                listElement.innerHTML = '<div class="no-results">No Pokemon exists</div>';
                return;
            }
            
            for (let result of results) {
                let item = document.createElement('div');
                item.className = 'pokemon-item';
                item.innerHTML = `#${result.id} ${result.name} (${result.type1}${result.type2 ? '/' + result.type2 : ''}) - Gen ${result.generation}`;
                
                item.addEventListener('click', function() {
                    inputElement.value = result.name;
                    detailsElement.innerHTML = `#${result.id} ${result.name} (${result.type1}${result.type2 ? '/' + result.type2 : ''}) - Gen ${result.generation}${result.legendary ? ' - Legendary' : ''}`;
                    selectionElement.classList.add('active');
                    listElement.style.display = 'none';
                    
                    // Clear the search input
                    let searchInput = listElement.previousElementSibling.previousElementSibling;
                    searchInput.value = '';
                    
                    // Check if both Pokemon are selected
                    checkBothSelected();
                });
                
                listElement.appendChild(item);
            }
        }
        
        // Function to check if any filter is active and show results automatically
        function updatePokemon1List() {
            const searchText = document.getElementById('pokemon1-search').value;
            const type1Filter = document.getElementById('pokemon1-type1').value;
            const type2Filter = document.getElementById('pokemon1-type2').value;
            const genFilter = document.getElementById('pokemon1-generation').value;
            const listElement = document.getElementById('pokemon1-list');
            const inputElement = document.getElementById('pokemon1');
            const selectionElement = document.getElementById('pokemon1-selection');
            const detailsElement = document.getElementById('pokemon1-details');
            
            // Show results if any filter is selected, even if search text is empty
            if (type1Filter !== '' || type2Filter !== '' || genFilter !== '' || searchText !== '') {
                filterPokemon(searchText, type1Filter, type2Filter, genFilter, listElement, inputElement, selectionElement, detailsElement);
            } else {
                listElement.style.display = 'none';
            }
        }
        
        function updatePokemon2List() {
            const searchText = document.getElementById('pokemon2-search').value;
            const type1Filter = document.getElementById('pokemon2-type1').value;
            const type2Filter = document.getElementById('pokemon2-type2').value;
            const genFilter = document.getElementById('pokemon2-generation').value;
            const listElement = document.getElementById('pokemon2-list');
            const inputElement = document.getElementById('pokemon2');
            const selectionElement = document.getElementById('pokemon2-selection');
            const detailsElement = document.getElementById('pokemon2-details');
            
            // Show results if any filter is selected, even if search text is empty
            if (type1Filter !== '' || type2Filter !== '' || genFilter !== '' || searchText !== '') {
                filterPokemon(searchText, type1Filter, type2Filter, genFilter, listElement, inputElement, selectionElement, detailsElement);
            } else {
                listElement.style.display = 'none';
            }
        }
        
        // Function to check if both Pokemon are selected
        function checkBothSelected() {
            const pokemon1 = document.getElementById('pokemon1').value;
            const pokemon2 = document.getElementById('pokemon2').value;
            const predictBtn = document.getElementById('predict-btn');
            
            if (pokemon1 && pokemon2) {
                predictBtn.disabled = false;
            } else {
                predictBtn.disabled = true;
            }
        }
        
        // Set up event listeners for Pokemon 1
        document.getElementById('pokemon1-search').addEventListener('input', updatePokemon1List);
        document.getElementById('pokemon1-type1').addEventListener('change', updatePokemon1List);
        document.getElementById('pokemon1-type2').addEventListener('change', updatePokemon1List);
        document.getElementById('pokemon1-generation').addEventListener('change', updatePokemon1List);
        
        // Set up event listeners for Pokemon 2
        document.getElementById('pokemon2-search').addEventListener('input', updatePokemon2List);
        document.getElementById('pokemon2-type1').addEventListener('change', updatePokemon2List);
        document.getElementById('pokemon2-type2').addEventListener('change', updatePokemon2List);
        document.getElementById('pokemon2-generation').addEventListener('change', updatePokemon2List);
        
        // Set up clear button for Pokemon 1
        document.getElementById('remove-pokemon1').addEventListener('click', function() {
            document.getElementById('pokemon1').value = '';
            document.getElementById('pokemon1-selection').classList.remove('active');
            checkBothSelected();
        });
        
        // Set up clear button for Pokemon 2
        document.getElementById('remove-pokemon2').addEventListener('click', function() {
            document.getElementById('pokemon2').value = '';
            document.getElementById('pokemon2-selection').classList.remove('active');
            checkBothSelected();
        });
        
        // Close the Pokemon list when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('#pokemon1-list') && 
                !event.target.closest('#pokemon1-search') &&
                !event.target.closest('#pokemon1-type1') &&
                !event.target.closest('#pokemon1-type2') &&
                !event.target.closest('#pokemon1-generation')) {
                document.getElementById('pokemon1-list').style.display = 'none';
            }
            if (!event.target.closest('#pokemon2-list') && 
                !event.target.closest('#pokemon2-search') &&
                !event.target.closest('#pokemon2-type1') &&
                !event.target.closest('#pokemon2-type2') &&
                !event.target.closest('#pokemon2-generation')) {
                document.getElementById('pokemon2-list').style.display = 'none';
            }
        });
        
        // Form submission validation
        document.getElementById('battle-form').addEventListener('submit', function(event) {
            const pokemon1 = document.getElementById('pokemon1').value;
            const pokemon2 = document.getElementById('pokemon2').value;
            
            if (!pokemon1 || !pokemon2) {
                event.preventDefault();
                alert('Please select two Pokemon to battle');
                return;
            }
            
            document.getElementById('predict-btn').disabled = true;
            document.getElementById('loading-message').style.display = 'block';
        });
        
        // Initially disable the predict button until both Pokemon are selected
        document.getElementById('predict-btn').disabled = true;
    </script>
</body>
</html> 